@baseUrl = http://localhost:30577
###@baseUrl = https://apiqa.solmar.com

@cliente_jwt = Bearer eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImRpdXJ2YW4xQGdtYWlsLmNvbSIsImdpdmVuX25hbWUiOiJOdWV2byBVc3VhcmlvIiwic3ViIjoiY2Q2YjNhNjQtYTk1OC00NTMxLTkwMDgtYzMzMDI5N2M1OTZlIiwiQXNwTmV0LklkZW50aXR5LlNlY3VyaXR5U3RhbXAiOiJQQkRRQ09CVEdRNk40T05OSktJUjJVSEpCSE1SQzRPRiIsInJvbGUiOiJDbGllbnRlIiwibmJmIjoxNzY5NzEwNDMxLCJleHAiOjE3NzAzMTUyMzEsImlhdCI6MTc2OTcxMDQzMSwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NzAwMSIsImF1ZCI6Imh0dHBzOi8vbG9jYWxob3N0OjcwMDEifQ.aSSelqOt9pebadKjC7mtGcW2yXibReccRA8wC2uwzCxG254uCtW3Tf4Pr2tpb7H8hxZBffwiFWz467akAnNAyg

###
# @name getCategories
# Obtiene todas las categorías de notificaciones.
GET {{baseUrl}}/api/notifications/notifications/categories
Authorization: {{cliente_jwt}}

###
# @name getActions
# Obtiene todas las actions por categoria
GET {{baseUrl}}/api/notifications/notifications/category/1/actions
Authorization: {{cliente_jwt}}

###

# @name getMyInAppNotifications
# Obtiene las notificaciones In-App del usuario autenticado.
GET {{baseUrl}}/api/notifications/notifications/me/in-app
Authorization: {{cliente_jwt}}

###

# @name getMyInAppNotificationsByCategory
# Obtiene las notificaciones In-App del usuario, filtradas por categoría.
GET {{baseUrl}}/api/notifications/notifications/me/in-app?categoryId=1
Authorization: {{cliente_jwt}}

###

# @name markAsRead
# Marca una notificación In-App como leída.
POST {{baseUrl}}/api/notifications/notifications/{{notificationId}}/mark-as-read
Authorization: {{cliente_jwt}}

###

# @name createInAppNotification
# Crea una notificación In-App para un usuario.
# Roles permitidos: AdministradorSistema
POST {{baseUrl}}/api/notifications/notifications/in-app
Content-Type: application/json
Authorization: {{admin_jwt}}

{
  "usuarioId": "{{userId}}",
  "mensaje": "Este es un mensaje de prueba desde el nuevo endpoint.",
  "notificationCategoryId": 1
}

# Archivo de peticiones para NotificationsService a través del YARP Proxy
# =================================================================
# La ruta del controlador ha sido modificada para coincidir con la
# ruta que el YARP Proxy está enviando al servicio (sin el prefijo /api/).
#
# Estructura de la URL:
# {{baseUrl}}/api/notifications/notifications/{endpoint}
# =================================================================

@pushNotificationId = AQUÍ_VA_UN_ID_DE_PUSH_NOTIFICACION

###
# =====================================================
# Email Notifications
# =====================================================

# @name sendTemplatedEmail
# Envía un correo electrónico utilizando una plantilla HTML.
# Roles permitidos: AdministradorSistema, GerenteHotel
#  // templateName: PaymentProcessed, Promotion
# // subject: Opcional
POST {{baseUrl}}/api/notifications/notifications/send-templated-email
Content-Type: application/json
Authorization: {{admin_jwt}}

{
  "toEmail": "diurvan1@gmail.com",
  "templateName": "CodeVerification",
  "subject": "Confirmación de tu Reserva Solmar",
  "data": {
    "Email": "diurvan1@gmail.com",
    "veryficationcode": "1234"
  }
}

###

POST {{baseUrl}}/api/notifications/notifications/send-business-email
Content-Type: application/json
Authorization: {{cliente_jwt}}

{
  "emailType": "MemberRequest",
  "templateName": "MemberRequest",
  "subject": "Solicitud para Member",
  "data": {
    "type": "email",
    "value": "diurvan1@gmail.com"
  }
}

###
# =====================================================
# Push Notifications
# =====================================================

# @name sendPushNotification
# Crea y envía una notificación push.
# Roles permitidos: AdministradorSistema, GerenteHotel
POST {{baseUrl}}/api/notifications/notifications/send-push
Content-Type: application/json
Authorization: {{admin_jwt}}

{
  "userId": "AQUÍ_VA_EL_USER_ID_DESTINO",
  "notificationCategoryId": 1,
  "type": "reservation_confirmed",
  "title": "Tu reserva ha sido confirmada!",
  "description": "Hemos confirmado tu reserva para el hotel X en la fecha Y.",
  "origin": "ReservationsService",
  "deepLink": "solmarapp://reservations/123"
}

###

# @name getMyPushNotifications
# Obtiene todas las notificaciones push del usuario autenticado.
GET {{baseUrl}}/api/notifications/notifications/me/push
Authorization: {{cliente_jwt}}

###

# @name getMyUnreadPushNotifications
# Obtiene las notificaciones push no leídas del usuario autenticado.
GET {{baseUrl}}/api/notifications/notifications/me/push/unread
Authorization: {{cliente_jwt}}

###

# @name markPushNotificationAsRead
# Marca una notificación push como leída.
POST {{baseUrl}}/api/notifications/notifications/push/{{pushNotificationId}}/mark-as-read
Authorization: {{cliente_jwt}}

###

# @name markPushNotificationAsPinned
# Marca una notificación push como anclada.
POST {{baseUrl}}/api/notifications/notifications/push/{{pushNotificationId}}/mark-as-pinned
Authorization: {{cliente_jwt}}

###

# @name unmarkPushNotificationAsPinned
# Desmarca una notificación push como anclada.
POST {{baseUrl}}/api/notifications/notifications/push/{{pushNotificationId}}/mark-as-pinned?pin=false
Authorization: {{cliente_jwt}}

###
# =====================================================
# Notification Dispatcher
# =====================================================

# @name dispatchNotification
# Dispara un evento para que el sistema de notificaciones lo procese.
# Este es el nuevo endpoint central.
POST {{baseUrl}}/api/notifications/dispatch
Content-Type: application/json

{
  "eventName": "PromotionPush",
  "payload": {
    "UserId": "36fd007b-1d4e-41e5-b082-a9c7cf463188",
    "UserEmail": "diurvan1@gmail.com",
    "UserName": "Diurvan"
  }
}

###


##
# Devuelve conteo de notificaciones sin leer de un Usuario
GET {{baseUrl}}/api/notifications/notifications/me/count
Authorization: {{cliente_jwt}}