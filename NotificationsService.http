@baseUrl = http://localhost:30577
# @baseUrl = https://apiqa.solmar.com

@cliente_jwt = Bearer eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImRpdXJ2YW4xQGdtYWlsLmNvbSIsImdpdmVuX25hbWUiOiJJdsOhbiBUYXBpYSIsInN1YiI6IjI3YzI3Y2U2LTJhNmItNGFjYS1hMjg0LTg2YTM2YjUxYjk1MiIsIkFzcE5ldC5JZGVudGl0eS5TZWN1cml0eVN0YW1wIjoiSlFHQjNNVFYySkFPRjVRSkxCTkRZSzRGNERMSVVJREEiLCJuYmYiOjE3Njg5MzI2MDMsImV4cCI6MTc2OTUzNzQwMywiaWF0IjoxNzY4OTMyNjAzLCJpc3MiOiJodHRwczovL2xvY2FsaG9zdDo3MDAxIiwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NzAwMSJ9.a030XE1rTtmO1f3u9MGCpnr2dXJ2n2UP3wip3XDIz5zK4zxJvY6pobYXhDFA9LVU9qQdAGdGFbmi2XYbQ1YmMQ

###
# @name getCategories
# Obtiene todas las categorías de notificaciones.
GET {{baseUrl}}/api/notifications/categories
Authorization: {{cliente_jwt}}

###

# @name getMyInAppNotifications
# Obtiene las notificaciones In-App del usuario autenticado.
GET {{baseUrl}}/api/notifications/me/in-app
Authorization: {{cliente_jwt}}

###

# @name getMyInAppNotificationsByCategory
# Obtiene las notificaciones In-App del usuario, filtradas por categoría.
GET {{baseUrl}}/api/notifications/me/in-app?categoryId=1
Authorization: {{cliente_jwt}}

###

# @name markAsRead
# Marca una notificación In-App como leída.
POST {{baseUrl}}/api/notifications/{{notificationId}}/mark-as-read
Authorization: {{cliente_jwt}}

###

# @name createInAppNotification
# Crea una notificación In-App para un usuario.
# Roles permitidos: AdministradorSistema
POST {{baseUrl}}/api/notifications/in-app
Content-Type: application/json
Authorization: {{admin_jwt}}

{
  "usuarioId": "{{userId}}",
  "mensaje": "Este es un mensaje de prueba desde el nuevo endpoint.",
  "notificationCategoryId": 1
}

# Archivo de peticiones para NotificationsService a través del YARP Proxy
# =================================================================
# La ruta del controlador ha sido modificada para coincidir con la
# ruta que el YARP Proxy está enviando al servicio (sin el prefijo /api/).
#
# Estructura de la URL:
# {{baseUrl}}/api/notifications/{endpoint}
# =================================================================

@pushNotificationId = AQUÍ_VA_UN_ID_DE_PUSH_NOTIFICACION

###
# =====================================================
# Email Notifications
# =====================================================

# @name sendTemplatedEmail
# Envía un correo electrónico utilizando una plantilla HTML.
# Roles permitidos: AdministradorSistema, GerenteHotel
#  // templateName: PaymentProcessed, Promotion
# // subject: Opcional
POST {{baseUrl}}/api/notifications/send-templated-email
Content-Type: application/json
Authorization: {{admin_jwt}}

{
  "toEmail": "diurvan1@gmail.com",
  "templateName": "CodeVerification",
  "subject": "Confirmación de tu Reserva Solmar",
  "data": {
    "Email": "diurvan1@gmail.com",
    "veryficationcode": "1234"
  }
}

###
# =====================================================
# Push Notifications
# =====================================================

# @name sendPushNotification
# Crea y envía una notificación push.
# Roles permitidos: AdministradorSistema, GerenteHotel
POST {{baseUrl}}/api/notifications/send-push
Content-Type: application/json
Authorization: {{admin_jwt}}

{
  "userId": "AQUÍ_VA_EL_USER_ID_DESTINO",
  "notificationCategoryId": 1,
  "type": "reservation_confirmed",
  "title": "Tu reserva ha sido confirmada!",
  "description": "Hemos confirmado tu reserva para el hotel X en la fecha Y.",
  "origin": "ReservationsService",
  "deepLink": "solmarapp://reservations/123"
}

###

# @name getMyPushNotifications
# Obtiene todas las notificaciones push del usuario autenticado.
GET {{baseUrl}}/api/notifications/me/push
Authorization: {{cliente_jwt}}

###

# @name getMyUnreadPushNotifications
# Obtiene las notificaciones push no leídas del usuario autenticado.
GET {{baseUrl}}/api/notifications/me/push/unread
Authorization: {{cliente_jwt}}

###

# @name markPushNotificationAsRead
# Marca una notificación push como leída.
POST {{baseUrl}}/api/notifications/push/{{pushNotificationId}}/mark-as-read
Authorization: {{cliente_jwt}}

###

# @name markPushNotificationAsPinned
# Marca una notificación push como anclada.
POST {{baseUrl}}/api/notifications/push/{{pushNotificationId}}/mark-as-pinned
Authorization: {{cliente_jwt}}

###

# @name unmarkPushNotificationAsPinned
# Desmarca una notificación push como anclada.
POST {{baseUrl}}/api/notifications/push/{{pushNotificationId}}/mark-as-pinned?pin=false
Authorization: {{cliente_jwt}}

###
# =====================================================
# Notification Dispatcher
# =====================================================

# @name dispatchNotification
# Dispara un evento para que el sistema de notificaciones lo procese.
# Este es el nuevo endpoint central.
POST {{baseUrl}}/api/notifications/dispatch
Content-Type: application/json

{
  "eventName": "PasswordResetCodeRequested",
  "payload": {
    "UserId": "36fd007b-1d4e-41e5-b082-a9c7cf463188",
    "UserEmail": "diurvan1@gmail.com",
    "UserName": "Diurvan"
  }
}

###
